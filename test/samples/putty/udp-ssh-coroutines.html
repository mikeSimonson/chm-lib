<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=US-ASCII">
<title>Coroutines in ssh.c</title>
<link rel="previous" href="udp-makefiles-auto.html">
<link rel="ToC" href="index.html">
<link rel="next" href="udp-compile-once.html">
<link rel="stylesheet" type="text/css" href="chm.css"></head>
<body>
<h1><a name="udp-ssh-coroutines"></a>D.12 Coroutines in <code>ssh.c</code></h1>
<p>
Large parts of the code in <code>ssh.c</code> are structured using a set of macros that implement (something close to) Donald Knuth's &#8216;coroutines&#8217; concept in C.
</p>
<p>
Essentially, the purpose of these macros are to arrange that a function can call <code>crReturn()</code> to return to its caller, and the next time it is called control will resume from just after that <code>crReturn</code> statement.
</p>
<p>
This means that any local (automatic) variables declared in such a function will be corrupted every time you call <code>crReturn</code>. If you need a variable to persist for longer than that, you <em>must</em> make it a field in one of the persistent state structures: either the local state structures <code>s</code> or <code>st</code> in each function, or the backend-wide structure <code>ssh</code>.
</p>
<p>
See <a href="http://www.chiark.greenend.org.uk/~sgtatham/coroutines.html"><code>http://www.chiark.greenend.org.uk/~sgtatham/coroutines.html</code></a> for a more in-depth discussion of what these macros are for and how they work.
</p>

<!-- version IDs:
PuTTY release 0.67
-->
</body>
</html>
